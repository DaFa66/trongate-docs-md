# The Pagination Helper


The Trongate framework includes a built-in [Pagination class](documentation-ref/list_refs/class_reference/the-pagination-class) for generating numbered navigation links when displaying multiple pages of content. Below is an example of the pagination output generated by Trongate:



    ![screenshot](https://trongate.io/images/32/paginatiVwds.png)
    
*Pagination screenshot.*


## How It Works


Trongate's pagination helper is available for immediate use and can be implemented in three steps:


1. **Define Pagination Data** - Create an array in the controller.
2. **Pass Data to View** - Send the pagination data to a view file.
3. **Invoke Pagination** - Call the pagination helper from the view file.

## Defining Pagination Data


The following example demonstrates how to configure pagination data:

```php
$pagination_data["total_rows"] = count($rows);
$pagination_data["limit"] = 10;
$pagination_data["record_name_plural"] = "books";
$pagination_data["include_showing_statement"] = true;
$pagination_data["include_css"] = true;
$data["pagination_data"] = $pagination_data;
```


The pagination helper does not interact directly with the database. Instead, it uses predefined data from a results set.

### Required Properties


The following properties **must** be included in the `$pagination_data` array. If any are missing or have an incorrect type, the script will terminate with an error message (e.g., "Pagination Error: Missing required property: total_rows (expected type: int)").


- **`total_rows`**: The total number of records available. *Type: int*

```vf
$pagination_data["total_rows"] = count($rows);
```


- **`limit`**: The maximum number of records per page. *Type: int*

```vf
$pagination_data["limit"] = 10;
```


- **`record_name_plural`**: Specifies the plural label for the records. *Type: string*

```vf
$pagination_data["record_name_plural"] = "books";
```

### Optional Properties


These properties are optional and have default values if not specified. They allow customization of the pagination behavior and appearance.


- **`page_num_segment`**: The URL segment number indicating the current page. If not specified (default: `null`), the last URL segment is used if numeric; otherwise, it defaults to page 1. *Type: int*

```vf
$pagination_data["page_num_segment"] = 3;
```


- **`pagination_root`**: The base URL for pagination links. If not specified (default: `null`), it is derived from the current URL, removing the last segment if numeric, and ensuring a trailing slash. *Type: string*

```vf
$pagination_data["pagination_root"] = "books/manage/";
```


- **`include_showing_statement`**: Determines whether a "Showing x to y of z" statement is displayed above the pagination links. Default: `false`. *Type: bool*

```vf
$pagination_data["include_showing_statement"] = true;
```


- **`include_css`**: Determines whether default CSS styles are included in the output as a `<style>` block. Default: `false`. If omitted or `false`, you must style the pagination links yourself. *Type: bool*

```vf
$pagination_data["include_css"] = true;
```


- **`num_links_per_page`**: The maximum number of numbered pagination links to display. Default: `10`. Links are centered around the current page. *Type: int*

```vf
$pagination_data["num_links_per_page"] = 6;
```


- **`settings`**: An array to customize the HTML structure, labels, and ARIA attributes of pagination links. Default: an empty array (`[]`), which uses predefined defaults (see "Customizing Pagination with `settings`"). *Type: array*

```vf
$pagination_data["settings"] = ["first_link" => "Start", "next_link" => ">>"];
```

#### Customizing Pagination with settings


The `settings` property allows you to override the default appearance and behavior of pagination links. If not provided, the class uses a predefined `$default_settings` array. You can specify custom values for any of the following keys:


- **`pagination_open`**: Opening tag for the pagination container. Default: `<div class="pagination">`
- **`pagination_close`**: Closing tag for the pagination container. Default: `</div>`
- **`cur_link_open`**: Opening tag for the current page link. Default: `<a class="active">`
- **`cur_link_close`**: Closing tag for the current page link. Default: `</a>`
- **`num_link_open`**: Opening tag for numbered links. Default: `''` (empty string)
- **`num_link_close`**: Closing tag for numbered links. Default: `''` (empty string)
- **`first_link`**: Text for the "First" button. Default: `First`
- **`first_link_open`**: Opening tag for the "First" button. Default: `''`
- **`first_link_close`**: Closing tag for the "First" button. Default: `''`
- **`first_link_aria_label`**: ARIA label for the "First" button. Default: `First page`
- **`last_link`**: Text for the "Last" button. Default: `Last`
- **`last_link_open`**: Opening tag for the "Last" button. Default: `''`
- **`last_link_close`**: Closing tag for the "Last" button. Default: `''`
- **`last_link_aria_label`**: ARIA label for the "Last" button. Default: `Last page`
- **`prev_link`**: Text for the "Previous" button. Default: `«`
- **`prev_link_open`**: Opening tag for the "Previous" button. Default: `''`
- **`prev_link_close`**: Closing tag for the "Previous" button. Default: `''`
- **`prev_link_aria_label`**: ARIA label for the "Previous" button. Default: `Previous page`
- **`next_link`**: Text for the "Next" button. Default: `»`
- **`next_link_open`**: Opening tag for the "Next" button. Default: `''`
- **`next_link_close`**: Closing tag for the "Next" button. Default: `''`
- **`next_link_aria_label`**: ARIA label for the "Next" button. Default: `Next page`


**Example:**

```php
$custom_settings = [
    "pagination_open" => "<nav class=\"pag-nav\">",
    "pagination_close" => "</nav>",
    "cur_link_open" => "<span class=\"current\">",
    "cur_link_close" => "</span>",
    "first_link" => "<< Start",
    "last_link" => "End >>",
    "prev_link" => "< Prev",
    "next_link" => "Next >",
    "first_link_aria_label" => "Go to first page"
];
$pagination_data["settings"] = $custom_settings;
```


If any required keys are missing from your custom `settings` array, the script will terminate with an error (e.g., "Pagination Error: Missing required settings property: pagination_open").

#### Default CSS with include_css


When `include_css` is set to `true`, the following CSS is injected into the HTML output as a `<style>` block:

```css
.pagination {
    display: inline-block;
    margin: 0 0 1em 0;
}
.pagination:last-of-type {
    margin-top: 1em;
}
.pagination a {
    color: black;
    float: left;
    padding: 8px 16px;
    text-decoration: none;
    border: 1px solid #ddd;
}
.pagination a.active {
    background-color: var(--primary);
    color: white;
    border: 1px solid var(--primary);
}
.pagination a:hover:not(.active) {
    background-color: #ddd;
}
.pagination a:first-child {
    border-top-left-radius: 5px;
    border-bottom-left-radius: 5px;
}
.pagination a:last-child {
    border-top-right-radius: 5px;
    border-bottom-right-radius: 5px;
}
@media screen and (max-width: 550px) {
    .pagination a {
        padding: 10px 14px; /* Larger touch targets on mobile */
    }
}
```


This provides a clean, responsive design with hover effects, an active state, and larger touch targets on mobile devices. If you prefer custom styles, set `include_css` to `false` and define your own CSS.

### Derived Properties


The `Pagination` class calculates the following properties automatically and adds them to `$pagination_data`. These are not set manually but are available for reference:


- **`root`**: The full base URL for pagination links (e.g., `http://example.com/books/manage/`).
- **`current_page`**: The current page number (e.g., `2`).
- **`start`**: The first page number in the link range (e.g., `1`).
- **`end`**: The last page number in the link range (e.g., `10`).
- **`num_links_to_side`**: Half of `num_links_per_page` for link distribution (e.g., `5`).
- **`num_pages`**: Total number of pages (e.g., `ceil(total_rows / limit)`).
- **`prev`**: Previous page number or empty string if on page 1.
- **`next`**: Next page number or last page number if on the last page.
- **`showing_statement`**: Text like "Showing 11 to 20 of 100 books." if `include_showing_statement` is `true`.

## Passing Pagination Data to a View File


The example below demonstrates how to declare and pass pagination data in a controller:

```php
function manage() {
  $data["headline"] = "Manage Books";
  $all_rows = $this->model->get("book_title");

  $pagination_data["total_rows"] = count($all_rows);
  $pagination_data["limit"] = $this->_get_limit();
  $pagination_data["record_name_plural"] = "books";
  $pagination_data["include_showing_statement"] = true;
  $pagination_data["include_css"] = true;
  $data["pagination_data"] = $pagination_data;

  $data["rows"] = $this->_reduce_rows($all_rows);
  $data["view_module"] = "books";
  $data["view_file"] = "manage";
  $this->template("admin", $data);
}
```

## Invoking Pagination from a View File


Once the pagination data has been passed into a view file, pagination elements can be rendered by invoking the display() method:

```vf
<?= Pagination::display($pagination_data) ?>
```

## Mobile-Friendly Pagination


When viewed on smaller screens, pagination components can extend beyond the screen width, leading to usability issues. The default CSS (with `include_css` set to `true`) includes a media query for screens under 550px, increasing padding for touch targets. For further customization, consider these approaches:


- Using CSS media queries to hide or modify pagination elements on smaller screens.
- Implementing a simplified mobile format (e.g., "Previous" and "Next" buttons only).
- Using JavaScript to dynamically adjust pagination based on screen width.


Below is an example JavaScript solution for mobile pagination:

```javascript
<script>
// Central function to manage pagination based on viewport width
function managePagination() {
    const paginationContainers = document.querySelectorAll('.pagination-container');
    const isMobile = window.innerWidth < 840;

    paginationContainers.forEach(container => container.style.opacity = 0);
    isMobile ? applyMobileView() : applyDesktopView();
    setTimeout(() => {
        paginationContainers.forEach(container => container.style.opacity = 1);
    }, 50);
}

// Function to apply mobile view
function applyMobileView() {
    document.querySelectorAll('.pagination-container').forEach(container => {
        container.classList.add('pagination-mobile');
    });

    document.querySelectorAll('.pagination').forEach(pagination => {
        const links = Array.from(pagination.querySelectorAll('a'));
        const activeLink = pagination.querySelector('a.active') || pagination.querySelector('.active');
        const prevLink = links.find(link => link.textContent.includes('«'));
        const nextLink = links.find(link => link.textContent.includes('»'));

        links.forEach(link => link.style.display = 'none');
        [activeLink, prevLink, nextLink].forEach(link => {
            if (link) link.style.display = '';
        });
    });
}

// Function to apply desktop view
function applyDesktopView() {
    document.querySelectorAll('.pagination-container').forEach(container => {
        container.classList.remove('pagination-mobile');
    });

    document.querySelectorAll('.pagination').forEach(pagination => {
        pagination.querySelectorAll('a').forEach(link => link.style.display = '');
    });
}

window.addEventListener('load', managePagination);
let resizeTimer;
window.addEventListener('resize', () => {
    clearTimeout(resizeTimer);
    document.querySelectorAll('.pagination-container').forEach(container => container.style.opacity = 0);
    resizeTimer = setTimeout(managePagination, 250);
});
</script>

<style>
.pagination-container {
    transition: opacity 0.3s ease;
}
</style>
```


The JavaScript code shown above is structured around three main functions:


1. **managePagination()**: The central function that coordinates everything

- Sets opacity to 0 during manipulation
- Checks viewport width and applies the appropriate view
- Reveals the pagination after changes are complete


2. **applyMobileView()**: Handles the mobile view (screens < 840px)

- Adds the "pagination-mobile" class for styling hooks
- Shows only essential elements: active page, previous («), and next (»)
- Hides all other pagination links


3. **applyDesktopView()**: Handles the desktop view (screens ≥ 840px)

- Removes the "pagination-mobile" class
- Shows all pagination links




The code also includes debounced resize handling to prevent performance issues during browser resizing.


This approach gives us the best of both worlds - a fully featured pagination on desktop and a simplified, touch-friendly version on mobile, all while maintaining the core functionality of the Trongate framework.

> [!NOTE]
> **Just To Let You Know...**
>
> For the above JavaScript to work, wrap each pagination element in a `<div class="pagination-container">` with initial `opacity: 0`:
> 
> ```vf
> <?php if (isset($pagination_data)) { ?>
>     <div class="pagination-container" style="opacity: 0;"><?= Pagination::display($pagination_data) ?></div>
> <?php } ?>
> ```
> 
> 
> The `.pagination-mobile` class is added on mobile devices, allowing custom styling:
> 
> ```css
> .pagination-container {
>     transition: opacity 0.3s ease;
> }
> .pagination-mobile .pagination a:first-child,
> .pagination-mobile .pagination a:last-child {
>     border-radius: 0;
> }
> ```


## Final Thoughts


Trongate's [Pagination class](documentation-ref/list_refs/class_reference/the-pagination-class) provides a flexible way to add pagination to webpages. Recent enhancements include automatic URL segment detection, customizable `settings`, and ARIA attributes for accessibility. Whether using the default styles with `include_css` or tailoring the output with custom `settings`, the class offers a robust solution for developers.

